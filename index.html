<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Mini App Info</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f9f9f9;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .table {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .row {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: #fff;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .key {
            font-weight: bold;
            color: #333;
        }
        .value {
            word-break: break-word;
            color: #555;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Данные Mini App</h2>
        <div class="table" id="dataTable"></div>
    </div>

    <script>
        function createRow(key, value) {
            const row = document.createElement('div');
            row.classList.add('row');

            const keyDiv = document.createElement('div');
            keyDiv.classList.add('key');
            keyDiv.textContent = key;

            const valueDiv = document.createElement('div');
            valueDiv.classList.add('value');
            valueDiv.textContent = value;

            row.appendChild(keyDiv);
            row.appendChild(valueDiv);
            return row;
        }

        function parseAndDisplayData() {
            const dataTable = document.getElementById('dataTable');
            const webApp = window.Telegram.WebApp;

            if (!webApp.initData || webApp.initData === '') {
                dataTable.appendChild(createRow('Ошибка', 'Данные отсутствуют'));
                return;
            }

            const initDataParams = new URLSearchParams(webApp.initData);
            const parsedInitData = {};

            for (const [key, value] of initDataParams.entries()) {
                parsedInitData[key] = decodeURIComponent(value);
            }

            // Добавляем `initData` по ключ-значение
            dataTable.appendChild(createRow('initData (строка)', webApp.initData));

            Object.keys(parsedInitData).forEach((key) => {
                dataTable.appendChild(createRow(`initData → ${key}`, parsedInitData[key]));
            });

            // Добавляем `initDataUnsafe` в JSON-формате
            if (webApp.initDataUnsafe) {
                dataTable.appendChild(createRow('initDataUnsafe', JSON.stringify(webApp.initDataUnsafe, null, 2)));
                Object.keys(webApp.initDataUnsafe).forEach((key) => {
                    dataTable.appendChild(createRow(`initDataUnsafe → ${key}`, JSON.stringify(webApp.initDataUnsafe[key], null, 2)));
                });
            }

            // Добавляем `themeParams`
            if (webApp.themeParams) {
                dataTable.appendChild(createRow('themeParams', JSON.stringify(webApp.themeParams, null, 2)));
                Object.keys(webApp.themeParams).forEach((key) => {
                    dataTable.appendChild(createRow(`themeParams → ${key}`, webApp.themeParams[key]));
                });
            }
        }

        window.onload = parseAndDisplayData;
    </script>
</body>
</html>
